/*! Moment Duration Format v1.3.0
 *  https://github.com/jsmreese/moment-duration-format 
 *  Date: 2014-07-15
 *
 *  Duration format plugin function for the Moment.js library
 *  http://momentjs.com/
 *
 *  Copyright 2014 John Madhavan-Reese
 *  Released under the MIT license
 */
(function(n){function e(n){var t="";if(n=parseInt(n,10),!n||n<1)return t;while(n)t+="0",n-=1;return t}function r(n,t,i){return n==null&&(n=""),n=""+n,(i?n:"")+e(t-n.length)+(i?"":n)}function l(n){return Object.prototype.toString.call(n)==="[object Array]"}function a(n){return Object.prototype.toString.call(n)==="[object Object]"}function v(n,t){for(var i=n.length;i-=1;)if(t(n[i]))return n[i]}function o(n,t){var i=0,u=n.length,r;for(typeof t!="function"&&(r=t,t=function(n){return n===r});i<u;){if(t(n[i]))return n[i];i+=1}}function t(n,t){var i=0,r=n.length;if(n&&r)while(i<r){if(t(n[i],i)===!1)return;i+=1}}function u(n,t){var i=0,u=n.length,r=[];if(!n||!u)return r;while(i<u)r[i]=t(n[i],i),i+=1;return r}function s(n,t){return u(n,function(n){return n[t]})}function y(n){var i=[];return t(n,function(n){n&&i.push(n)}),i}function h(n){var i=[];return t(n,function(n){o(i,n)||i.push(n)}),i}function p(n,i){var r=[];return t(n,function(n){t(i,function(t){n===t&&r.push(n)})}),h(r)}function c(n,i){var r=[];return t(n,function(t,u){if(!i(t))return r=n.slice(u),!1}),r}function w(n,t){var i=n.slice().reverse();return c(i,t).reverse()}function f(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}var i;if(typeof require=="function")try{i=require("moment")}catch(b){}if(!i&&n.moment&&(i=n.moment),!i)throw"Moment Duration Format cannot find Moment.js";i.duration.fn.format=function(){var g,v,b,nt,k,d,it=[].slice.call(arguments),n=f({},this.format.defaults),tt=i.duration(this);return(n.duration=this,t(it,function(t){if(typeof t=="string"||typeof t=="function"){n.template=t;return}if(typeof t=="number"){n.precision=t;return}a(t)&&f(n,t)}),b=n.types=l(n.types)?n.types:n.types.split(" "),typeof n.template=="function"&&(n.template=n.template.apply(n)),g=new RegExp(u(b,function(t){return n[t].source}).join("|"),"g"),nt=function(t){return o(b,function(i){return n[i].test(t)})},v=u(n.template.match(g),function(t,i){var r=nt(t),u=t.length;return{index:i,length:u,token:r==="escape"?t.replace(n.escape,"$1"):t,type:r==="escape"||r==="general"?null:r}},this),k=p(b,h(y(s(v,"type")))),!k.length)?s(v,"token").join(""):(t(k,function(i,r){var u,e,s,h,o;u=tt.as(i);e=u>0?Math.floor(u):Math.ceil(u);s=u-e;h=r+1===k.length;o=!r;t(v,function(t){t.type===i&&(f(t,{value:u,wholeValue:e,decimalValue:s,isLeast:h,isMost:o}),o&&n.forceLength==null&&t.length>1&&(n.forceLength=!0))});tt.subtract(e,i)}),n.trim&&(v=(n.trim==="left"?c:w)(v,function(n){return!(n.isLeast||n.type!=null&&n.wholeValue)})),d=!1,n.trim==="right"&&v.reverse(),v=u(v,function(t){var i,u;if(!t.type)return t.token;if(i=t.isLeast&&n.precision<0?(Math.floor(t.wholeValue*Math.pow(10,n.precision))*Math.pow(10,-n.precision)).toString():t.wholeValue.toString(),i=i.replace(/^\-/,""),t.length>1&&(d||t.isMost||n.forceLength)&&(i=r(i,t.length)),t.isLeast&&n.precision>0){u=t.decimalValue.toString().replace(/^\-/,"").split(/\.|e\-/);switch(u.length){case 1:i+="."+r(u[0],n.precision,!0).slice(0,n.precision);break;case 2:i+="."+r(u[1],n.precision,!0).slice(0,n.precision);break;case 3:i+="."+r(e(+u[2]-1)+(u[0]||"0")+u[1],n.precision,!0).slice(0,n.precision);break;default:throw"Moment Duration Format: unable to parse token decimal value.";}}return t.isMost&&t.value<0&&(i="-"+i),d=!0,i}),n.trim==="right"&&v.reverse(),v.join(""))};i.duration.fn.format.defaults={escape:/\[(.+?)\]/,years:/[Yy]+/,months:/M+/,weeks:/[Ww]+/,days:/[Dd]+/,hours:/[Hh]+/,minutes:/m+/,seconds:/s+/,milliseconds:/S+/,general:/.+?/,types:"escape years months weeks days hours minutes seconds milliseconds general",trim:"left",precision:0,forceLength:null,template:function(){var n=this.types,t=this.duration,i=v(n,function(n){return t._data[n]});switch(i){case"seconds":return"h:mm:ss";case"minutes":return"d[d] h:mm";case"hours":return"d[d] h[h]";case"days":return"M[m] d[d]";case"weeks":return"y[y] w[w]";case"months":return"y[y] M[m]";case"years":return"y[y]";default:return"y[y] M[m] d[d] h:mm:ss"}}}})(this)